<h2 class="game-title"><i class="fas fa-rocket"></i> Cohete Multiplicador</h2>
<div class="rocket-game-container">
    <div class="rocket-background" id="rocketBackground"></div>
    
    <div class="multiplier-display" id="rocketMultiplier">x1.00</div>
    
    <div class="rocket" id="rocket">
        <div class="rocket-nose"></div>
        <div class="rocket-body"></div>
    </div>
    
    <div id="rocketExplosion" style="position: absolute; width: 200px; height: 200px; background: radial-gradient(circle, #ff9900, #ff3300); border-radius: 50%; opacity: 0; filter: blur(20px); transition: opacity 0.5s; z-index: 4; display: none;"></div>
    
    <div style="position: absolute; top: 150px; left: 0; right: 0; z-index: 5; text-align: center;">
        <div style="display: flex; justify-content: center; gap: 20px; margin: 20px 0; flex-wrap: wrap;">
            <div style="text-align: center;">
                <div style="font-size: 0.9rem; opacity: 0.8;">APUESTA</div>
                <div style="display: flex; align-items: center; gap: 15px; margin-top: 10px;">
                    <button class="cyber-button" id="rocketDecrease" style="width: 50px; height: 50px; border-radius: 50%; padding: 0;">-100</button>
                    <div style="font-size: 2rem; font-weight: 700; color: var(--secondary-color); min-width: 120px;" id="rocketBet">1000</div>
                    <button class="cyber-button" id="rocketIncrease" style="width: 50px; height: 50px; border-radius: 50%; padding: 0;">+100</button>
                </div>
            </div>
            
            <div style="text-align: center;">
                <div style="font-size: 0.9rem; opacity: 0.8;">GANANCIA POTENCIAL</div>
                <div style="font-size: 2rem; font-weight: 700; color: gold; margin-top: 10px;" id="potentialWin">1000 PIX</div>
            </div>
        </div>
    </div>
    
    <div style="position: absolute; bottom: 20px; left: 0; right: 0; z-index: 5; text-align: center;">
        <button class="cyber-button green" id="rocketLaunch" style="padding: 15px 50px; font-size: 1.2rem; margin-right: 10px;">Lanzar Cohete</button>
        <button class="cyber-button yellow" id="rocketCashout" style="padding: 15px 50px; font-size: 1.2rem; display: none;">Retirar</button>
    </div>
</div>

<script>
    // Juego del cohete
    let rocketFlying = false;
    let rocketMultiplier = 1.0;
    let rocketBet = 1000;
    let rocketInterval;
    
    const rocket = document.getElementById('rocket');
    const multiplierDisplay = document.getElementById('rocketMultiplier');
    const betDisplay = document.getElementById('rocketBet');
    const potentialWinDisplay = document.getElementById('potentialWin');
    const launchButton = document.getElementById('rocketLaunch');
    const cashoutButton = document.getElementById('rocketCashout');
    const rocketExplosion = document.getElementById('rocketExplosion');
    
    // Actualizar apuesta
    function updateBet(amount) {
        rocketBet += amount;
        if (rocketBet < 10) rocketBet = 10;
        if (rocketBet > 10000) rocketBet = 10000;
        betDisplay.textContent = rocketBet;
        updatePotentialWin();
    }
    
    function updatePotentialWin() {
        const potential = Math.floor(rocketBet * rocketMultiplier);
        potentialWinDisplay.textContent = `${potential} PIX`;
    }
    
    // Botones de apuesta
    document.getElementById('rocketIncrease').addEventListener('click', () => updateBet(100));
    document.getElementById('rocketDecrease').addEventListener('click', () => updateBet(-100));
    
    // Botón de lanzar
    launchButton.addEventListener('click', launchRocket);
    
    // Botón de retirar
    cashoutButton.addEventListener('click', cashoutRocket);
    
    function launchRocket() {
        if (rocketFlying) return;
        
        window.parent.postMessage({ type: 'deductBalance', amount: rocketBet }, '*');
        
        rocketFlying = true;
        rocketMultiplier = 1.0;
        launchButton.style.display = 'none';
        cashoutButton.style.display = 'inline-block';
        
        // Iniciar vuelo
        let height = 50;
        rocketInterval = setInterval(() => {
            height += 5;
            rocketMultiplier += 0.1 + Math.random() * 0.2;
            
            rocket.style.bottom = `${height}px`;
            multiplierDisplay.textContent = `x${rocketMultiplier.toFixed(2)}`;
            updatePotentialWin();
            
            // Verificar explosión aleatoria
            if (Math.random() * 100 < 5) {
                crashRocket();
            }
            
            // Límite máximo
            if (height >= 400 || rocketMultiplier >= 50) {
                crashRocket();
            }
        }, 100);
    }
    
    function cashoutRocket() {
        if (!rocketFlying) return;
        
        clearInterval(rocketInterval);
        rocketFlying = false;
        
        const winAmount = Math.floor(rocketBet * rocketMultiplier);
        window.parent.postMessage({ type: 'addBalance', amount: winAmount }, '*');
        
        // Resetear cohete
        rocket.style.bottom = '50px';
        launchButton.style.display = 'inline-block';
        cashoutButton.style.display = 'none';
    }
    
    function crashRocket() {
        if (!rocketFlying) return;
        
        clearInterval(rocketInterval);
        rocketFlying = false;
        
        // Mostrar explosión
        rocketExplosion.style.display = 'block';
        rocketExplosion.style.opacity = '1';
        rocketExplosion.style.left = '50%';
        rocketExplosion.style.bottom = rocket.style.bottom;
        
        setTimeout(() => {
            rocketExplosion.style.opacity = '0';
            setTimeout(() => {
                rocketExplosion.style.display = 'none';
            }, 500);
        }, 500);
        
        // Ocultar cohete
        rocket.style.opacity = '0';
        
        // Resetear después de la explosión
        setTimeout(() => {
            rocket.style.opacity = '1';
            rocket.style.bottom = '50px';
            launchButton.style.display = 'inline-block';
            cashoutButton.style.display = 'none';
        }, 1000);
    }
    
    updatePotentialWin();
</script>